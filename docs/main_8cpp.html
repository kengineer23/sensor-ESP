<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ISAAC-ESP: OneDrive/Documents/PlatformIO/Projects/ESP1/src/main.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ISAAC-ESP<span id="projectnumber">&#160;V0.1</span>
   </div>
   <div id="projectbrief">The firmware is responsible for communicating data between the sensor ESP and Heroku along with offline speech recognition</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ded2a7f905c2d34630c595c5cf4eb434.html">OneDrive</a></li><li class="navelem"><a class="el" href="dir_dd52ae2abab4d41f938861f86ff3f034.html">Documents</a></li><li class="navelem"><a class="el" href="dir_8ffec51004e2431b5ce2e98c91350723.html">PlatformIO</a></li><li class="navelem"><a class="el" href="dir_f97b326aff994f3b123e3fbb5deb4e27.html">Projects</a></li><li class="navelem"><a class="el" href="dir_dc6b4de1c0ebf1f02f2e84a64bb96223.html">ESP1</a></li><li class="navelem"><a class="el" href="dir_1aaa96be24a96e788af7b3eb4e5df408.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">main.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Firmware for ESP32 responsible for communication with cloud ESP, sensor data collectiona and conditional <a class="el" href="class_b_l_d_c.html" title="A class for controlling a Brushless DC (BLDC) motor using PWM.">BLDC</a> motor control.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;Arduino.h&gt;</code><br />
<code>#include &lt;WiFi.h&gt;</code><br />
<code>#include &lt;NTPClient.h&gt;</code><br />
<code>#include &lt;HTTPClient.h&gt;</code><br />
<code>#include &lt;WebServer.h&gt;</code><br />
<code>#include &lt;ArduinoJson.h&gt;</code><br />
<code>#include &lt;Preferences.h&gt;</code><br />
<code>#include &lt;PubSubClient.h&gt;</code><br />
<code>#include &lt;<a class="el" href="_d_h_t11_sensor_8h_source.html">DHT11Sensor.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_p_m_s5003_sensor_8h_source.html">PMS5003Sensor.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_m_q7_sensor_8h_source.html">MQ7Sensor.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="_led_control_8h_source.html">LedControl.h</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="_b_l_d_c_8h_source.html">BLDC.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="_b_l_e_8h_source.html">BLE.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sensor_data.html">SensorData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure to hold data from various sensors.  <a href="struct_sensor_data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structled_parameters.html">ledParameters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure to hold RGB color values for an LED.  <a href="structled_parameters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a757bb4e2bff6148de6ef3989b32a0126" id="r_a757bb4e2bff6148de6ef3989b32a0126"><td class="memItemLeft" align="right" valign="top"><a id="a757bb4e2bff6148de6ef3989b32a0126" name="a757bb4e2bff6148de6ef3989b32a0126"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DHTPIN</b>&#160;&#160;&#160;15</td></tr>
<tr class="separator:a757bb4e2bff6148de6ef3989b32a0126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c509dba12bba99883a5be9341b7a0c5" id="r_a2c509dba12bba99883a5be9341b7a0c5"><td class="memItemLeft" align="right" valign="top"><a id="a2c509dba12bba99883a5be9341b7a0c5" name="a2c509dba12bba99883a5be9341b7a0c5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DHTTYPE</b>&#160;&#160;&#160;DHT11</td></tr>
<tr class="separator:a2c509dba12bba99883a5be9341b7a0c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0068397e842325969e7b0b2875fd9f29" id="r_a0068397e842325969e7b0b2875fd9f29"><td class="memItemLeft" align="right" valign="top"><a id="a0068397e842325969e7b0b2875fd9f29" name="a0068397e842325969e7b0b2875fd9f29"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MQ7</b>&#160;&#160;&#160;33</td></tr>
<tr class="separator:a0068397e842325969e7b0b2875fd9f29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebf7d7651fae7e2d53d4df0f294261a8" id="r_aebf7d7651fae7e2d53d4df0f294261a8"><td class="memItemLeft" align="right" valign="top"><a id="aebf7d7651fae7e2d53d4df0f294261a8" name="aebf7d7651fae7e2d53d4df0f294261a8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PWMPin</b>&#160;&#160;&#160;5</td></tr>
<tr class="separator:aebf7d7651fae7e2d53d4df0f294261a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aee63e84c606cfaefce454689113c636c" id="r_aee63e84c606cfaefce454689113c636c"><td class="memItemLeft" align="right" valign="top"><a id="aee63e84c606cfaefce454689113c636c" name="aee63e84c606cfaefce454689113c636c"></a>
PubSubClient&#160;</td><td class="memItemRight" valign="bottom"><b>client</b> (espClient)</td></tr>
<tr class="separator:aee63e84c606cfaefce454689113c636c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af37d7564fe7119dd267379028ba5e69f" id="r_af37d7564fe7119dd267379028ba5e69f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af37d7564fe7119dd267379028ba5e69f">TaskDHT11</a> (void *pvParameters)</td></tr>
<tr class="memdesc:af37d7564fe7119dd267379028ba5e69f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task for collecting data from the DHT11 sensor.  <br /></td></tr>
<tr class="separator:af37d7564fe7119dd267379028ba5e69f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48749ed4907bda93e2602169a688ffce" id="r_a48749ed4907bda93e2602169a688ffce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48749ed4907bda93e2602169a688ffce">TaskPMS5003</a> (void *pvParameters)</td></tr>
<tr class="memdesc:a48749ed4907bda93e2602169a688ffce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task for collecting data from the PMS5003 sensor.  <br /></td></tr>
<tr class="separator:a48749ed4907bda93e2602169a688ffce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5da619e02a99181444984cb380f41164" id="r_a5da619e02a99181444984cb380f41164"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5da619e02a99181444984cb380f41164">TaskMQ7</a> (void *pvParameters)</td></tr>
<tr class="memdesc:a5da619e02a99181444984cb380f41164"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task for monitoring gas levels using the MQ7 sensor.  <br /></td></tr>
<tr class="separator:a5da619e02a99181444984cb380f41164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bcd6ce7d04c38f8c4ff908d1fc50f86" id="r_a4bcd6ce7d04c38f8c4ff908d1fc50f86"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4bcd6ce7d04c38f8c4ff908d1fc50f86">reconnect</a> ()</td></tr>
<tr class="memdesc:a4bcd6ce7d04c38f8c4ff908d1fc50f86"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is responsible for connecting the ESP32 to the Mosquitto MQTT Broker.  <br /></td></tr>
<tr class="separator:a4bcd6ce7d04c38f8c4ff908d1fc50f86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a810cdd1dbedf380fd17e0767aff4e7e7" id="r_a810cdd1dbedf380fd17e0767aff4e7e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a810cdd1dbedf380fd17e0767aff4e7e7">TaskSendToServer</a> (void *pvParameters)</td></tr>
<tr class="memdesc:a810cdd1dbedf380fd17e0767aff4e7e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task for sending sensor data to an MQTT server.  <br /></td></tr>
<tr class="separator:a810cdd1dbedf380fd17e0767aff4e7e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc0e01608944d3ff8dd3e90c8a088a47" id="r_acc0e01608944d3ff8dd3e90c8a088a47"><td class="memItemLeft" align="right" valign="top"><a id="acc0e01608944d3ff8dd3e90c8a088a47" name="acc0e01608944d3ff8dd3e90c8a088a47"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>controlLed</b> ()</td></tr>
<tr class="separator:acc0e01608944d3ff8dd3e90c8a088a47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4406cb24d23518a90756f2fdfb6601a" id="r_aa4406cb24d23518a90756f2fdfb6601a"><td class="memItemLeft" align="right" valign="top"><a id="aa4406cb24d23518a90756f2fdfb6601a" name="aa4406cb24d23518a90756f2fdfb6601a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>motorControlTask</b> ()</td></tr>
<tr class="separator:aa4406cb24d23518a90756f2fdfb6601a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeab2f678ad886fb7a6c48a77ce97d410" id="r_aeab2f678ad886fb7a6c48a77ce97d410"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeab2f678ad886fb7a6c48a77ce97d410">callback</a> (char *topic, byte *message, unsigned int length)</td></tr>
<tr class="memdesc:aeab2f678ad886fb7a6c48a77ce97d410"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for handling incoming MQTT messages.  <br /></td></tr>
<tr class="separator:aeab2f678ad886fb7a6c48a77ce97d410"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c29d185e70d5c80d2fec126e56bdf3c" id="r_a9c29d185e70d5c80d2fec126e56bdf3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9c29d185e70d5c80d2fec126e56bdf3c">TaskReceiveFromServer</a> (void *pvParameters)</td></tr>
<tr class="memdesc:a9c29d185e70d5c80d2fec126e56bdf3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task for handling incoming MQTT messages.  <br /></td></tr>
<tr class="separator:a9c29d185e70d5c80d2fec126e56bdf3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d6e87ed8e72e16adffe9d97254f4320" id="r_a2d6e87ed8e72e16adffe9d97254f4320"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d6e87ed8e72e16adffe9d97254f4320">connect_to_WIFI</a> ()</td></tr>
<tr class="memdesc:a2d6e87ed8e72e16adffe9d97254f4320"><td class="mdescLeft">&#160;</td><td class="mdescRight">Connects to a WiFi network.  <br /></td></tr>
<tr class="separator:a2d6e87ed8e72e16adffe9d97254f4320"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a730483d3310dfdd2b0942ce7be93c96a" id="r_a730483d3310dfdd2b0942ce7be93c96a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a730483d3310dfdd2b0942ce7be93c96a">WiFiCredentials</a> (void *pvParameters)</td></tr>
<tr class="memdesc:a730483d3310dfdd2b0942ce7be93c96a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task for receiving and processing WiFi credentials via BLE.  <br /></td></tr>
<tr class="separator:a730483d3310dfdd2b0942ce7be93c96a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fc01d736fe50cf5b977f755b675f11d" id="r_a4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr class="memdesc:a4fc01d736fe50cf5b977f755b675f11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the system and sets up tasks for sensor data handling and communication.  <br /></td></tr>
<tr class="separator:a4fc01d736fe50cf5b977f755b675f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe461d27b9c48d5921c00d521181f12f" id="r_afe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top"><a id="afe461d27b9c48d5921c00d521181f12f" name="afe461d27b9c48d5921c00d521181f12f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>loop</b> ()</td></tr>
<tr class="separator:afe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae62fa8557ef4586408dcbe2f1a09e839" id="r_ae62fa8557ef4586408dcbe2f1a09e839"><td class="memItemLeft" align="right" valign="top"><a id="ae62fa8557ef4586408dcbe2f1a09e839" name="ae62fa8557ef4586408dcbe2f1a09e839"></a>
const char *&#160;</td><td class="memItemRight" valign="bottom"><b>mqtt_server</b> = &quot; 192.168.1.249&quot;</td></tr>
<tr class="memdesc:ae62fa8557ef4586408dcbe2f1a09e839"><td class="mdescLeft">&#160;</td><td class="mdescRight">IP address of your MQTT broker. <br /></td></tr>
<tr class="separator:ae62fa8557ef4586408dcbe2f1a09e839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4f28c882f3fb17a47d7bfea3dd5cc02" id="r_ae4f28c882f3fb17a47d7bfea3dd5cc02"><td class="memItemLeft" align="right" valign="top"><a id="ae4f28c882f3fb17a47d7bfea3dd5cc02" name="ae4f28c882f3fb17a47d7bfea3dd5cc02"></a>
const int&#160;</td><td class="memItemRight" valign="bottom"><b>mqtt_port</b> = 1883</td></tr>
<tr class="memdesc:ae4f28c882f3fb17a47d7bfea3dd5cc02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default MQTT port. <br /></td></tr>
<tr class="separator:ae4f28c882f3fb17a47d7bfea3dd5cc02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd77e757e4b3bb6f1e4b42b21ea9e040" id="r_abd77e757e4b3bb6f1e4b42b21ea9e040"><td class="memItemLeft" align="right" valign="top"><a id="abd77e757e4b3bb6f1e4b42b21ea9e040" name="abd77e757e4b3bb6f1e4b42b21ea9e040"></a>
WiFiClient&#160;</td><td class="memItemRight" valign="bottom"><b>espClient</b></td></tr>
<tr class="separator:abd77e757e4b3bb6f1e4b42b21ea9e040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea06cf7b8092a0adaf07614d7ece59d" id="r_a6ea06cf7b8092a0adaf07614d7ece59d"><td class="memItemLeft" align="right" valign="top"><a id="a6ea06cf7b8092a0adaf07614d7ece59d" name="a6ea06cf7b8092a0adaf07614d7ece59d"></a>
Preferences&#160;</td><td class="memItemRight" valign="bottom"><b>preferences</b></td></tr>
<tr class="memdesc:a6ea06cf7b8092a0adaf07614d7ece59d"><td class="mdescLeft">&#160;</td><td class="mdescRight">To write network credentials permanently in ESP32's File system. <br /></td></tr>
<tr class="separator:a6ea06cf7b8092a0adaf07614d7ece59d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26e302558819c8850c96ac6a9d056e77" id="r_a26e302558819c8850c96ac6a9d056e77"><td class="memItemLeft" align="right" valign="top"><a id="a26e302558819c8850c96ac6a9d056e77" name="a26e302558819c8850c96ac6a9d056e77"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>proceed</b> = false</td></tr>
<tr class="memdesc:a26e302558819c8850c96ac6a9d056e77"><td class="mdescLeft">&#160;</td><td class="mdescRight">MongoDB Data API settings. <br /></td></tr>
<tr class="separator:a26e302558819c8850c96ac6a9d056e77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44b1ff0b52b96ed3367f4684f6100c1e" id="r_a44b1ff0b52b96ed3367f4684f6100c1e"><td class="memItemLeft" align="right" valign="top"><a id="a44b1ff0b52b96ed3367f4684f6100c1e" name="a44b1ff0b52b96ed3367f4684f6100c1e"></a>
const char *&#160;</td><td class="memItemRight" valign="bottom"><b>apiKeySEND</b> = &quot;eN2shi0T52prrIrWwmK4NxnLCVM4wefv1Gx5hHLAiLohz510h1vaS84p9AVjKYWI&quot;</td></tr>
<tr class="separator:a44b1ff0b52b96ed3367f4684f6100c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb2f81b785513b19424279496b878730" id="r_aeb2f81b785513b19424279496b878730"><td class="memItemLeft" align="right" valign="top"><a id="aeb2f81b785513b19424279496b878730" name="aeb2f81b785513b19424279496b878730"></a>
const char *&#160;</td><td class="memItemRight" valign="bottom"><b>endpointSEND</b> = &quot;https://ap-south-1.aws.data.mongodb-api.com/app/data-giddkzt/endpoint/data/v1/action/insertOne&quot;</td></tr>
<tr class="separator:aeb2f81b785513b19424279496b878730"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41fcfafc0e39fe55710383f93579097b" id="r_a41fcfafc0e39fe55710383f93579097b"><td class="memItemLeft" align="right" valign="top"><a id="a41fcfafc0e39fe55710383f93579097b" name="a41fcfafc0e39fe55710383f93579097b"></a>
<a class="el" href="class_d_h_t11_sensor.html">DHT11Sensor</a>&#160;</td><td class="memItemRight" valign="bottom"><b>dht11</b> (DHTPIN, DHTTYPE)</td></tr>
<tr class="memdesc:a41fcfafc0e39fe55710383f93579097b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an object of custom class <a class="el" href="class_d_h_t11_sensor.html" title="A class for interfacing with the DHT11 temperature and humidity sensor.">DHT11Sensor</a>. <br /></td></tr>
<tr class="separator:a41fcfafc0e39fe55710383f93579097b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa045a745e9171af655d205eac5ccad9" id="r_aaa045a745e9171af655d205eac5ccad9"><td class="memItemLeft" align="right" valign="top"><a id="aaa045a745e9171af655d205eac5ccad9" name="aaa045a745e9171af655d205eac5ccad9"></a>
<a class="el" href="class_m_q7_sensor.html">MQ7Sensor</a>&#160;</td><td class="memItemRight" valign="bottom"><b>mq7</b> (MQ7)</td></tr>
<tr class="memdesc:aaa045a745e9171af655d205eac5ccad9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an object of custom class <a class="el" href="class_m_q7_sensor.html" title="A class for interfacing with the MQ7 gas sensor.">MQ7Sensor</a>. <br /></td></tr>
<tr class="separator:aaa045a745e9171af655d205eac5ccad9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1443d5c6487d83f47be6a5072555cf36" id="r_a1443d5c6487d83f47be6a5072555cf36"><td class="memItemLeft" align="right" valign="top"><a id="a1443d5c6487d83f47be6a5072555cf36" name="a1443d5c6487d83f47be6a5072555cf36"></a>
<a class="el" href="class_p_m_s5003_sensor.html">PMS5003Sensor</a>&#160;</td><td class="memItemRight" valign="bottom"><b>pms5003</b></td></tr>
<tr class="memdesc:a1443d5c6487d83f47be6a5072555cf36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an object of custom class <a class="el" href="class_p_m_s5003_sensor.html" title="A class for interfacing with the PMS5003 particulate matter sensor.">PMS5003Sensor</a>. <br /></td></tr>
<tr class="separator:a1443d5c6487d83f47be6a5072555cf36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6ed671f3036da58a93991fca2a2329c" id="r_ae6ed671f3036da58a93991fca2a2329c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_sensor_data.html">SensorData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6ed671f3036da58a93991fca2a2329c">sensorData</a></td></tr>
<tr class="memdesc:ae6ed671f3036da58a93991fca2a2329c"><td class="mdescLeft">&#160;</td><td class="mdescRight">A variable to hold sensor data readings.  <br /></td></tr>
<tr class="separator:ae6ed671f3036da58a93991fca2a2329c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09ff05572125de4f09c9e3a0c11413c7" id="r_a09ff05572125de4f09c9e3a0c11413c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_led_control.html">LedControl</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a09ff05572125de4f09c9e3a0c11413c7">led</a></td></tr>
<tr class="memdesc:a09ff05572125de4f09c9e3a0c11413c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">LED control object for managing LED states.  <br /></td></tr>
<tr class="separator:a09ff05572125de4f09c9e3a0c11413c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46e63f73a6b7f85d4cda97396326340d" id="r_a46e63f73a6b7f85d4cda97396326340d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structled_parameters.html">ledParameters</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46e63f73a6b7f85d4cda97396326340d">ledcolor</a></td></tr>
<tr class="memdesc:a46e63f73a6b7f85d4cda97396326340d"><td class="mdescLeft">&#160;</td><td class="mdescRight">A variable to hold the LED color parameters.  <br /></td></tr>
<tr class="separator:a46e63f73a6b7f85d4cda97396326340d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b0f6b6aa3d7551ea11122e6edc29297" id="r_a0b0f6b6aa3d7551ea11122e6edc29297"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_b_l_d_c.html">BLDC</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b0f6b6aa3d7551ea11122e6edc29297">motor</a> (PWMPin)</td></tr>
<tr class="memdesc:a0b0f6b6aa3d7551ea11122e6edc29297"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_b_l_d_c.html" title="A class for controlling a Brushless DC (BLDC) motor using PWM.">BLDC</a> motor control object.  <br /></td></tr>
<tr class="separator:a0b0f6b6aa3d7551ea11122e6edc29297"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a095e5e806d8f6b23aae87a5c7ff58cea" id="r_a095e5e806d8f6b23aae87a5c7ff58cea"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a095e5e806d8f6b23aae87a5c7ff58cea">dutycycle</a></td></tr>
<tr class="memdesc:a095e5e806d8f6b23aae87a5c7ff58cea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Duty cycle for PWM signal.  <br /></td></tr>
<tr class="separator:a095e5e806d8f6b23aae87a5c7ff58cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1547b5f86aa85d72d872c0a758c02d31" id="r_a1547b5f86aa85d72d872c0a758c02d31"><td class="memItemLeft" align="right" valign="top">TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1547b5f86aa85d72d872c0a758c02d31">TaskDHT11Handle</a></td></tr>
<tr class="memdesc:a1547b5f86aa85d72d872c0a758c02d31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task handles for managing RTOS tasks.  <br /></td></tr>
<tr class="separator:a1547b5f86aa85d72d872c0a758c02d31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18139f7373fb97e4d62ce30774267492" id="r_a18139f7373fb97e4d62ce30774267492"><td class="memItemLeft" align="right" valign="top"><a id="a18139f7373fb97e4d62ce30774267492" name="a18139f7373fb97e4d62ce30774267492"></a>
TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>TaskPMS5003Handle</b></td></tr>
<tr class="separator:a18139f7373fb97e4d62ce30774267492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c7eca6a4529becc6c910e2ea6ac28af" id="r_a3c7eca6a4529becc6c910e2ea6ac28af"><td class="memItemLeft" align="right" valign="top"><a id="a3c7eca6a4529becc6c910e2ea6ac28af" name="a3c7eca6a4529becc6c910e2ea6ac28af"></a>
TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>TaskMQ7Handle</b></td></tr>
<tr class="separator:a3c7eca6a4529becc6c910e2ea6ac28af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a90fd7b0583a0aeccaf9843a4f3268b" id="r_a6a90fd7b0583a0aeccaf9843a4f3268b"><td class="memItemLeft" align="right" valign="top"><a id="a6a90fd7b0583a0aeccaf9843a4f3268b" name="a6a90fd7b0583a0aeccaf9843a4f3268b"></a>
TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>TaskSendToServerHandle</b></td></tr>
<tr class="memdesc:a6a90fd7b0583a0aeccaf9843a4f3268b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core 1. <br /></td></tr>
<tr class="separator:a6a90fd7b0583a0aeccaf9843a4f3268b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a916a6e1816c39b5a57d8a0e5945b0e0e" id="r_a916a6e1816c39b5a57d8a0e5945b0e0e"><td class="memItemLeft" align="right" valign="top"><a id="a916a6e1816c39b5a57d8a0e5945b0e0e" name="a916a6e1816c39b5a57d8a0e5945b0e0e"></a>
TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>TaskReceiveFromServerHandle</b></td></tr>
<tr class="separator:a916a6e1816c39b5a57d8a0e5945b0e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e86ae9bf21a0e9ddbba977366ee202a" id="r_a3e86ae9bf21a0e9ddbba977366ee202a"><td class="memItemLeft" align="right" valign="top"><a id="a3e86ae9bf21a0e9ddbba977366ee202a" name="a3e86ae9bf21a0e9ddbba977366ee202a"></a>
TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>TaskHandleWiFiCredentials</b></td></tr>
<tr class="separator:a3e86ae9bf21a0e9ddbba977366ee202a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42e6769ae8cd0f9f4a2d8dcbbb5bc32a" id="r_a42e6769ae8cd0f9f4a2d8dcbbb5bc32a"><td class="memItemLeft" align="right" valign="top">SemaphoreHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a42e6769ae8cd0f9f4a2d8dcbbb5bc32a">xSendSemaphore</a></td></tr>
<tr class="memdesc:a42e6769ae8cd0f9f4a2d8dcbbb5bc32a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Semaphore handles for synchronizing tasks.  <br /></td></tr>
<tr class="separator:a42e6769ae8cd0f9f4a2d8dcbbb5bc32a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cab43a770a83e7581cf39bb8003879c" id="r_a9cab43a770a83e7581cf39bb8003879c"><td class="memItemLeft" align="right" valign="top"><a id="a9cab43a770a83e7581cf39bb8003879c" name="a9cab43a770a83e7581cf39bb8003879c"></a>
SemaphoreHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>xStartSemaphore</b></td></tr>
<tr class="separator:a9cab43a770a83e7581cf39bb8003879c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba5096c5fc5aaa2ea64551b72abea9b1" id="r_aba5096c5fc5aaa2ea64551b72abea9b1"><td class="memItemLeft" align="right" valign="top"><a id="aba5096c5fc5aaa2ea64551b72abea9b1" name="aba5096c5fc5aaa2ea64551b72abea9b1"></a>
SemaphoreHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>xSendMutex</b></td></tr>
<tr class="separator:aba5096c5fc5aaa2ea64551b72abea9b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Firmware for ESP32 responsible for communication with cloud ESP, sensor data collectiona and conditional <a class="el" href="class_b_l_d_c.html" title="A class for controlling a Brushless DC (BLDC) motor using PWM.">BLDC</a> motor control. </p>
<p>This file includes functionalities for WiFi connectivity, BLE connectivity with Android, MQTT communication, HTTP requests, , collecting sensor data and controlling the speed of <a class="el" href="class_b_l_d_c.html" title="A class for controlling a Brushless DC (BLDC) motor using PWM.">BLDC</a> motor. The various sensors included are DHT11 for Temperature and Humidity, PMS5003 for PM2.5 levels and MQ7 for CO level detection.</p>
<dl class="section note"><dt>Note</dt><dd>Next: Mechanism for unsuccessful data collection Temporary ESP-NOW connection to send WiFi credentials on setup Switch to low-level/bare level programming to not be dependent on third-party libraries. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aeab2f678ad886fb7a6c48a77ce97d410" name="aeab2f678ad886fb7a6c48a77ce97d410"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeab2f678ad886fb7a6c48a77ce97d410">&#9670;&#160;</a></span>callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callback </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>topic</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>message</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function for handling incoming MQTT messages. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>Topic of the incoming message. </td></tr>
    <tr><td class="paramname">message</td><td>Pointer to the message payload. </td></tr>
    <tr><td class="paramname">length</td><td>Length of the message payload. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2d6e87ed8e72e16adffe9d97254f4320" name="a2d6e87ed8e72e16adffe9d97254f4320"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d6e87ed8e72e16adffe9d97254f4320">&#9670;&#160;</a></span>connect_to_WIFI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connect_to_WIFI </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Connects to a WiFi network. </p>
<p>This function attempts to connect to a WiFi network using a predefined SSID and password. It prints connection status updates to the serial monitor and waits until the connection is established. Once connected, it prints the assigned IP address.</p>
<dl class="section note"><dt>Note</dt><dd>The SSID and password are hardcoded in this implementation. Replace with dynamic values as needed.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Ensure that the WiFi credentials are kept secure and are not exposed in the source code in production environments. </dd></dl>

</div>
</div>
<a id="a4bcd6ce7d04c38f8c4ff908d1fc50f86" name="a4bcd6ce7d04c38f8c4ff908d1fc50f86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bcd6ce7d04c38f8c4ff908d1fc50f86">&#9670;&#160;</a></span>reconnect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reconnect </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is responsible for connecting the ESP32 to the Mosquitto MQTT Broker. </p>
<dl class="section note"><dt>Note</dt><dd>If the connection is successful the ESP is subscribed to collection 'isaac/action' and is a publisher to topic 'isaac/sensor_data'</dd>
<dd>
The following return codes(rc) indicate unsuccessful connections:<ul>
<li><b>0x01</b>: Incorrect Protocol Version - The server does not support the MQTT protocol version requested by the client.</li>
<li><b>0x02</b>: Invalid Client Identifier - The client identifier is not valid.</li>
<li><b>0x03</b>: Server Unavailable - The server is currently unavailable.</li>
<li><b>0x04</b>: Bad Username or Password - The username or password is incorrect.</li>
<li><b>0x05</b>: Not Authorized - The client is not authorized to connect to the server. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="a4fc01d736fe50cf5b977f755b675f11d" name="a4fc01d736fe50cf5b977f755b675f11d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fc01d736fe50cf5b977f755b675f11d">&#9670;&#160;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the system and sets up tasks for sensor data handling and communication. </p>
<p>This function is called once during the startup of the ESP32. It performs the following operations:</p><ul>
<li>Initializes serial communication at a baud rate of 9600.</li>
<li>Loads WiFi credentials from persistent storage (Flash memory) and waits for 10 seconds.</li>
<li>Initializes sensors (DHT11 and PMS5003).</li>
<li>Checks if WiFi credentials are available in persistent storage. If not, it sets up BLE and creates a task to handle WiFi credentials retrieval.</li>
<li>If WiFi credentials are found, it connects to the WiFi network.</li>
<li>Once connected to WiFi, it sets up the MQTT client with the server address and port.</li>
<li>Creates semaphores and a mutex for task synchronization.</li>
<li>Creates FreeRTOS tasks for sensor data collection, data sending, and data reception.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Tasks are pinned to specific cores as follows:<ul>
<li>Core 0: Tasks for sensor data collection (DHT11, PMS5003, MQ7) and sending data to the server.</li>
<li>Core 1: Task for receiving data from the server and handling WiFi credentials.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Ensure that the MQTT server address, port, and BLE setup are correctly configured for your specific use case. </dd></dl>

</div>
</div>
<a id="af37d7564fe7119dd267379028ba5e69f" name="af37d7564fe7119dd267379028ba5e69f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af37d7564fe7119dd267379028ba5e69f">&#9670;&#160;</a></span>TaskDHT11()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TaskDHT11 </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task for collecting data from the DHT11 sensor. </p>
<p>This FreeRTOS task reads temperature and humidity data from the DHT11 sensor and outputs the values to the serial monitor. It uses a semaphore to manage access to shared resources, ensuring data integrity and task synchronization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pvParameters</td><td>Pointer to the task parameters (unused in this task).</td></tr>
  </table>
  </dd>
</dl>
<p>The task runs indefinitely, attempting to read the DHT11 sensor every 5 seconds. If the mutex <code>xSendMutex</code> is available, it reads the sensor data and stores it in the <code>sensorData</code> structure. The task then releases the semaphore and mutex. If the sensor data is invalid, an error message is printed. </p>

</div>
</div>
<a id="a5da619e02a99181444984cb380f41164" name="a5da619e02a99181444984cb380f41164"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5da619e02a99181444984cb380f41164">&#9670;&#160;</a></span>TaskMQ7()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TaskMQ7 </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task for monitoring gas levels using the MQ7 sensor. </p>
<p>This FreeRTOS task monitors gas levels from the MQ7 gas sensor. It periodically updates the <code>sensorData</code> structure with the gas sensor readings and checks if the gas value exceeds a certain threshold. If gas is detected, it outputs a message to the serial monitor. The task uses a semaphore to signal other tasks when new data is available.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pvParameters</td><td>Pointer to the task parameters (unused in this task).</td></tr>
  </table>
  </dd>
</dl>
<p>The task runs indefinitely, checking the MQ7 sensor every 2 seconds. Currently, the sensor data is set to a fixed value for demonstration purposes. The task signals that new sensor data is available by giving the <code>xSendSemaphore</code> semaphore. If the gas value is equal to 1, indicating gas detection, a message is printed to the serial monitor. </p>

</div>
</div>
<a id="a48749ed4907bda93e2602169a688ffce" name="a48749ed4907bda93e2602169a688ffce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48749ed4907bda93e2602169a688ffce">&#9670;&#160;</a></span>TaskPMS5003()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TaskPMS5003 </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task for collecting data from the PMS5003 sensor. </p>
<p>This FreeRTOS task reads particulate matter data from the PMS5003 sensor and stores the readings in the <code>sensorData</code> structure. It uses a semaphore to manage access to shared resources, ensuring data integrity and task synchronization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pvParameters</td><td>Pointer to the task parameters (unused in this task).</td></tr>
  </table>
  </dd>
</dl>
<p>The task runs indefinitely, attempting to read the PMS5003 sensor every 2 seconds. If the mutex <code>xSendMutex</code> is available, it reads the sensor data and stores it in the <code>sensorData</code> structure. The task then releases the semaphore and mutex. </p>

</div>
</div>
<a id="a9c29d185e70d5c80d2fec126e56bdf3c" name="a9c29d185e70d5c80d2fec126e56bdf3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c29d185e70d5c80d2fec126e56bdf3c">&#9670;&#160;</a></span>TaskReceiveFromServer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TaskReceiveFromServer </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task for handling incoming MQTT messages. </p>
<p>This task ensures that the MQTT client is connected and processes incoming messages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pvParameters</td><td>Pointer to task parameters (not used). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a810cdd1dbedf380fd17e0767aff4e7e7" name="a810cdd1dbedf380fd17e0767aff4e7e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a810cdd1dbedf380fd17e0767aff4e7e7">&#9670;&#160;</a></span>TaskSendToServer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TaskSendToServer </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task for sending sensor data to an MQTT server. </p>
<p>This FreeRTOS task sends collected sensor data to an MQTT server in JSON format. It ensures data integrity and task synchronization by using semaphores and a mutex.</p>
<p>The task runs indefinitely and performs the following operations:</p><ul>
<li>Checks if the MQTT client is connected and processes incoming messages.</li>
<li>Takes multiple semaphores to ensure exclusive access to the sensor data.</li>
<li>Constructs a JSON payload containing sensor data from various sources.</li>
<li>Publishes the JSON payload to the specified MQTT topic.</li>
<li>Reconnects to the MQTT server if the connection is lost.</li>
<li>Delays for 10 seconds before sending the next data update.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pvParameters</td><td>Pointer to the task parameters (unused in this task).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The task uses three semaphores (<code>xSendSemaphore</code>) to synchronize access to sensor data, ensuring that data is not being modified while it is being sent. It also uses a mutex (<code>xSendMutex</code>) to stop other sensor tasks from accessing data while it is being processed.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The <code><a class="el" href="#a4bcd6ce7d04c38f8c4ff908d1fc50f86" title="This function is responsible for connecting the ESP32 to the Mosquitto MQTT Broker.">reconnect()</a></code> function should be implemented to handle reconnections to the MQTT server when the connection is lost. </dd></dl>
<p>&lt; Send data every 60 seconds</p>

</div>
</div>
<a id="a730483d3310dfdd2b0942ce7be93c96a" name="a730483d3310dfdd2b0942ce7be93c96a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a730483d3310dfdd2b0942ce7be93c96a">&#9670;&#160;</a></span>WiFiCredentials()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WiFiCredentials </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task for receiving and processing WiFi credentials via BLE. </p>
<p>This FreeRTOS task listens for new WiFi credentials received via BLE and attempts to connect to the specified WiFi network. The credentials are expected to be in the format "SSID:password". The task performs the following steps:</p><ul>
<li>Waits until valid WiFi credentials are received.</li>
<li>Parses the received data to extract SSID and password.</li>
<li>Stores the credentials in persistent storage.</li>
<li>Attempts to connect to the WiFi network using the extracted credentials.</li>
<li>If invalid credentials are received, it restarts BLE setup for reconfiguration.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pvParameters</td><td>Pointer to the task parameters (unused in this task).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The task continuously checks for connection status and processes new data only when it is available. It uses the <code>newData</code> flag to detect incoming credentials and the <code>receivedData</code> string to hold the data.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Ensure that BLE setup and WiFi connection logic are correctly implemented to handle various error scenarios and credential formats. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a095e5e806d8f6b23aae87a5c7ff58cea" name="a095e5e806d8f6b23aae87a5c7ff58cea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a095e5e806d8f6b23aae87a5c7ff58cea">&#9670;&#160;</a></span>dutycycle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t dutycycle</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Duty cycle for PWM signal. </p>
<p>This variable represents the duty cycle of the PWM signal, which determines the speed of the <a class="el" href="class_b_l_d_c.html" title="A class for controlling a Brushless DC (BLDC) motor using PWM.">BLDC</a> motor. The value of dutycycle ranges from 0 to 2047(2^11), which means 5 bits will be unused here. </p>

</div>
</div>
<a id="a09ff05572125de4f09c9e3a0c11413c7" name="a09ff05572125de4f09c9e3a0c11413c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09ff05572125de4f09c9e3a0c11413c7">&#9670;&#160;</a></span>led</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_led_control.html">LedControl</a> led</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LED control object for managing LED states. </p>
<p>This object is used to interface with and control an LED, allowing for operations such as setting colors and brightness. </p>

</div>
</div>
<a id="a46e63f73a6b7f85d4cda97396326340d" name="a46e63f73a6b7f85d4cda97396326340d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46e63f73a6b7f85d4cda97396326340d">&#9670;&#160;</a></span>ledcolor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structled_parameters.html">ledParameters</a> ledcolor</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A variable to hold the LED color parameters. </p>
<p>This variable is an instance of the <a class="el" href="structled_parameters.html" title="A structure to hold RGB color values for an LED.">ledParameters</a> structure and is used to define and store the current RGB color values for the LED. </p>

</div>
</div>
<a id="a0b0f6b6aa3d7551ea11122e6edc29297" name="a0b0f6b6aa3d7551ea11122e6edc29297"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b0f6b6aa3d7551ea11122e6edc29297">&#9670;&#160;</a></span>motor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_b_l_d_c.html">BLDC</a> motor(PWMPin) </td>
          <td>(</td>
          <td class="paramtype">PWMPin</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_b_l_d_c.html" title="A class for controlling a Brushless DC (BLDC) motor using PWM.">BLDC</a> motor control object. </p>
<p>This object is used to control a brushless DC (<a class="el" href="class_b_l_d_c.html" title="A class for controlling a Brushless DC (BLDC) motor using PWM.">BLDC</a>) motor using a PWM signal. The motor is connected to the specified PWM pin. The PWM signal is configured to produce a frequency of 20 kHz with a voltage range from 0 to 3.3V.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PWMPin</td><td>The GPIO pin used to generate the PWM signal. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae6ed671f3036da58a93991fca2a2329c" name="ae6ed671f3036da58a93991fca2a2329c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6ed671f3036da58a93991fca2a2329c">&#9670;&#160;</a></span>sensorData</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_sensor_data.html">SensorData</a> sensorData</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A variable to hold sensor data readings. </p>
<p>This variable is an instance of the <a class="el" href="struct_sensor_data.html" title="A structure to hold data from various sensors.">SensorData</a> structure and is used to store and manage the data from the DHT11, PMS5003, and MQ7 sensors. </p>

</div>
</div>
<a id="a1547b5f86aa85d72d872c0a758c02d31" name="a1547b5f86aa85d72d872c0a758c02d31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1547b5f86aa85d72d872c0a758c02d31">&#9670;&#160;</a></span>TaskDHT11Handle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TaskHandle_t TaskDHT11Handle</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task handles for managing RTOS tasks. </p>
<p>These handles are used to manage and control tasks within the RTOS. They allow operations such as starting, stopping, suspending, and resuming tasks. &lt; Core 0 </p>

</div>
</div>
<a id="a42e6769ae8cd0f9f4a2d8dcbbb5bc32a" name="a42e6769ae8cd0f9f4a2d8dcbbb5bc32a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42e6769ae8cd0f9f4a2d8dcbbb5bc32a">&#9670;&#160;</a></span>xSendSemaphore</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SemaphoreHandle_t xSendSemaphore</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Semaphore handles for synchronizing tasks. </p>
<p>These handles are used to manage semaphores in the RTOS, allowing tasks to synchronize their execution and manage shared resources safely. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
